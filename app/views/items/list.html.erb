<% @page_title = "Items List" %>

<h2>Items</h2>
<%= link_to('Back to list', {:action => 'list' , :group_name => ""}) %>

<ul class="nav nav-pills">
<h3> My Collections </h3>
<%if (params[:group_name] == "") %>
  <li class = "active">
  <%else%>
  <li>
  <%end%>
  <%= link_to "All", :action => 'list', :group_name => ""%>
  </li>
  
  <% if @groups != [] %>
<% @groups.each do |group| %>
<%if (params[:group_name] == group.name)%>
  <li class = "active">
  <%else%>
  <li>
  <%end%>
<%= link_to group.name, :action => 'list', :group_name => group.name %>
</li>
  <%end%>
<%end%>

</ul> 


<div class="tab-content">


<%if (params[:group_name] == "") %>

    <p>
    <%= link_to('Add New Item', {:action => 'new', :group_name => ""}, :class => 'btn-primary') %>
    </p>

    <div>
    <%= link_to(image_tag('icon_list.png'), {:action => 'list', :group_name => ""}) %>
    <%= link_to(image_tag('grid-icon1.png'), {:action => 'grid', :group_name => ""}) %>
    </div>
           
    <p>
    <div><%= pluralize(@items.size, 'item') %> found</div>
    </p>

    <%= form_for(:tag, :url => {:action => 'list'}, :method => 'GET') do |f| %>
        <%= select_tag :tag_name, options_from_collection_for_select(@tags, "name", "name"), :prompt => 'Filter by Tags', :onchange => 'submit()'%>
        <%= select_tag :event_name, options_from_collection_for_select(@events, "name", "name"), :prompt => 'Filter by Events', :onchange => 'submit()'%>
        <%= select_tag :description, options_for_select(["Image", "Text"]), :prompt => 'Filter by Type', :onchange => 'submit()'%>
        
        <%= hidden_field_tag 'group_name', "" %>

        <% if (params[:starred] == "1") %>
          <%= link_to('Show All Items', {:action => 'list', :group_name => ""}, :class => 'btn-primary') %>
        <%else%> 
          <%= link_to('Show Starred Items', {:action => 'list', :group_name => "", :starred => 1}, :class => 'btn-primary') %>
        <%end%>
    <% end %>


<%else%>

    <p>
    <%= link_to('Add New Item', {:action => 'new', :group_name => params[:group_name]}, :class => 'btn-primary') %>
    </p>

    <div>
    <%= link_to(image_tag('icon_list.png'), {:action => 'list', :group_name => params[:group_name]}) %>
    <%= link_to(image_tag('grid-icon1.png'), {:action => 'grid', :group_name => params[:group_name]}) %>
    </div>
           
    <p>
    <div><%= pluralize(@items.size, 'item') %> found</div>
    </p>

    <%= form_for(:tag, :url => {:action => 'list'}, :method => 'get')  do |f| %>
        
        <%= select_tag :tag_name, options_from_collection_for_select(@tags, "name", "name"), :prompt => 'Filter by Tags', :onchange => 'submit()'%>
        <%= select_tag :event_name, options_from_collection_for_select(@events, "name", "name"), :prompt => 'Filter by Events', :onchange => 'submit()'%>
        <%= select_tag :description, options_for_select(["Image", "Text"]), :prompt => 'Filter by Type', :onchange => 'submit()' %>

        <%= hidden_field_tag 'group_name', @group_name %>

        <% if (params[:starred] == "1") %>
          <%= link_to('Show All Items', {:action => 'list', :group_name => params[:group_name]}, :class => 'btn-primary') %>
        <%else%> 
            <%= link_to('Show Starred Items', {:action => 'list', :starred => 1, :group_name => params[:group_name]}, :class => 'btn-primary') %>
        <%end%>
    <%end%>
<%end%>


<div class="row">
  <div class="span12">
      <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered" id="example">

          <thead>
              <tr>
                <th width="50">ID</th>
                <th width="150">Item Name</th>
                <th width="150">Type</th>
                <th width="150">Notes</th>
                <th width="150">Tags</th>
                <th width="150">Events</th>
                <th width="150">Favorites</th>
                <th width="400">Actions </th>
              </tr>
          </thead>
          <tbody>
          <% @items.each do |item| %>
              <tr>
                <td><%= item.id %></td>
                <td><%= item.name %> </td>
                <td><%= item.description %></td>
                <td><%= item.note %></td>
                <td><%= item.tag_list %></td>
                <td><%= item.event_list %></td>
                <td>

<%if (item.starred == true) %>

                <%= form_for(:item, :url => {:action => 'update', :id => item.id, :group_name => params[:group_name]}, :method => 'PUT') do |f| %>

    
                <%= f.check_box :starred, {:onchange => 'submit()', :checked => true}, "yes", "no" %>
                <% end %>
               
                
              <% else %>
              
                <%= form_for(:item, :url => {:action => 'update', :id => item.id, :group_name => params[:group_name]}, :method => 'PUT') do |f| %>
                
                <%= f.check_box :starred, {:onchange => 'submit()', :checked => false} %>
                <% end %>
               

              <% end %>


                </td>
                <td>
                <%= link_to('Show',{:action => 'show', :id => item.id, :group_name => params[:group_name]}, :class => 'btn-primary')%> 
                <%= link_to('Edit', {:action => 'edit', :id => item.id, :group_name => params[:group_name]}, :class => 'btn-primary') %>
                  <%= link_to('Delete', {:action => 'delete', :id => item.id, :group_name => params[:group_name]}, :class => 'btn-primary') %></td>
              </tr>
          <% end %>
          </tbody>
      </table>

  </div>
  <div class="span4"></div>
</div>

  </div>


</div>

